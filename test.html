<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>三路複線図（技能試験風UI）</title>
<style>
body { font-family:sans-serif; }
svg { border:1px solid #ccc; }

.wire {
  stroke:black;
  stroke-width:3;
  fill:none;
}

.energized {
  stroke:red !important;
}

.switch-body {
  fill:none;
  stroke:black;
  stroke-width:2;
}

.contact {
  fill:black;
}

.arm {
  stroke:black;
  stroke-width:3;
}

.lamp {
  fill:none;
  stroke:black;
  stroke-width:2;
}

button { margin:5px; }
</style>
</head>
<body>

<h2>三路複線図（三路らしいUI）</h2>

<svg width="900" height="400">

  <!-- 電源 L/N -->
  <text x="50" y="80">L</text>
  <circle cx="70" cy="100" r="6" id="Lnode" />

  <text x="50" y="280">N</text>
  <circle cx="70" cy="300" r="6" id="Nnode" />

  <!-- N幹線 -->
  <path id="neutral_trunk" class="wire"
        d="M70 300 H820" />

  <!-- SW1 -->
  <g id="SW1" transform="translate(200,120)">
    <rect width="60" height="100" class="switch-body"/>
    <!-- 端子 -->
    <circle cx="30" cy="10" r="5" class="contact" id="SW1_C"/>
    <circle cx="10" cy="90" r="5" class="contact" id="SW1_A"/>
    <circle cx="50" cy="90" r="5" class="contact" id="SW1_B"/>
    <!-- 可動接点 -->
    <line id="SW1_arm" class="arm"
          x1="30" y1="10"
          x2="10" y2="90"/>
  </g>

  <!-- SW2 -->
  <g id="SW2" transform="translate(450,120)">
    <rect width="60" height="100" class="switch-body"/>
    <circle cx="30" cy="10" r="5" class="contact" id="SW2_C"/>
    <circle cx="10" cy="90" r="5" class="contact" id="SW2_A"/>
    <circle cx="50" cy="90" r="5" class="contact" id="SW2_B"/>
    <line id="SW2_arm" class="arm"
          x1="30" y1="10"
          x2="10" y2="90"/>
  </g>

  <!-- ランプ -->
  <g transform="translate(750,180)">
    <circle cx="0" cy="0" r="25" class="lamp"/>
    <text x="-5" y="5">R</text>
  </g>

  <!-- 配線 -->
  <path id="w1" class="wire"
        d="M70 100 H230" />

  <path id="w2" class="wire"
        d="M210 210 H460 210" />

  <path id="w3" class="wire"
        d="M250 210 H500 210" />

  <path id="w4" class="wire"
        d="M480 130 H750 180" />

  <path id="w5" class="wire"
        d="M750 205 V300 H70" />

</svg>

<div>
<button onclick="toggleSW1()">SW1切替</button>
<button onclick="toggleSW2()">SW2切替</button>
</div>

<script>

let sw1=false
let sw2=false

function toggleSW1(){
  sw1=!sw1
  document.getElementById("SW1_arm")
    .setAttribute("x2", sw1?50:10)
  reevaluate()
}

function toggleSW2(){
  sw2=!sw2
  document.getElementById("SW2_arm")
    .setAttribute("x2", sw2?50:10)
  reevaluate()
}

// 簡易導通判定（本物エンジンに置換可能）
function reevaluate(){

  document.querySelectorAll(".wire")
    .forEach(w=>w.classList.remove("energized"))

  const on = (sw1 === sw2)

  if(on){
    ["w1","w2","w4","w5"].forEach(id=>{
      document.getElementById(id)
        .classList.add("energized")
    })
  }
}

reevaluate()

</script>

</body>
</html>
