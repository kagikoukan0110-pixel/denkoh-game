:root{
  --bg:#000;
  --panel:#e6e6e6;
  --term-bg:#222;
  --wire:#ffd800;
  --wirew:5;
  --device-w:48px;    /* compact */
  --device-h:56px;
  --device-padding:6px;
  --boss-hp-color:#e74c3c;
  --boss-hp-back:#2b1818;
  --lamp-glow: rgba(255,220,80,0.95);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
#wireLayer{position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:3000}

/* header */
.header{display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
.title{font-size:20px;margin:0;font-weight:700}
.hp-area{width:46%;min-width:140px}
.bar{width:100%;height:12px;background:#222;border-radius:12px;overflow:hidden}
.player{height:100%;width:100%;background:#34d058;border-radius:12px}

/* board */
#board-wrap{position:relative;width:100%;height:calc(100vh - 240px);padding:8px 16px;overflow:hidden}
#board{position:relative;width:100%;height:100%}

/* devices compact */
.device{position:absolute;width:var(--device-w);height:var(--device-h);padding:var(--device-padding);background:var(--panel);border-radius:12px;color:#000;box-shadow:0 10px 26px rgba(0,0,0,0.5);transform:translate(-50%,-50%);text-align:center;z-index:60;display:flex;flex-direction:column;align-items:center;justify-content:center}
.device .icon{width:34px;height:34px;display:block}
.node .terminal{margin-top:6px;width:20px;height:20px;border-radius:50%;background:var(--term-bg);color:#fff;display:flex;align-items:center;justify-content:center;font-size:11px;cursor:pointer}
.junction{width:110px;height:70px;border-radius:14px;padding:8px}
.jb-dots{display:flex;gap:8px;align-items:center;justify-content:center}
.jb-term{width:12px;height:12px;border-radius:50%;background:#222;cursor:pointer}

/* controls */
.controls{height:180px;padding:12px 18px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}
.setBtn{padding:12px 28px;border-radius:26px;border:none;background:#ffd000;color:#000;font-weight:700}
.small{padding:8px 12px;margin:8px;border-radius:12px;border:none;background:#333;color:#fff}
.note{font-size:13px;color:#bbb;margin-top:8px;text-align:center}

/* modal & boss */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.75);display:none;align-items:flex-start;justify-content:center;flex-direction:column;padding:36px;z-index:9500}
.modal-backdrop.show{display:flex}
.titleBig{font-size:40px;color:#ffd200;font-weight:800;margin-bottom:12px}

#bossScreen{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9200}
#bossPanel{width:86%;max-width:820px;background:#0d0d0d;border-radius:14px;padding:18px;box-shadow:0 20px 60px rgba(0,0,0,0.7);display:flex;gap:18px;align-items:center}
#bossImg{width:200px;height:200px;background:linear-gradient(180deg,#222,#111);display:flex;align-items:center;justify-content:center;border-radius:10px;color:#fff}
.bossHPback{width:100%;height:14px;background:var(--boss-hp-back);border-radius:12px;overflow:hidden}
.bossHPbar{height:100%;width:100%;background:var(--boss-hp-color);transition:width 700ms ease;border-radius:12px}

/* hit text */
#hitText{position:absolute;top:8%;left:50%;transform:translateX(-50%);font-size:56px;color:#fff;z-index:9300;display:none;text-shadow:0 6px 18px rgba(0,0,0,0.6);font-weight:900}

/* effects */
.particle{position:fixed;width:8px;height:8px;border-radius:50%;background:rgba(255,230,120,0.95);z-index:9450;pointer-events:none}
#explosion{position:fixed;left:50%;top:40%;transform:translate(-50%,-50%) scale(0.01);width:360px;height:360px;border-radius:50%;pointer-events:none;z-index:9400;display:none;background:radial-gradient(circle at 50% 50%, rgba(255,250,200,0.95) 0%, rgba(255,180,60,0.92) 30%, rgba(220,60,10,0.9) 60%, rgba(0,0,0,0) 72%);box-shadow:0 0 80px rgba(255,180,60,0.6)}
#defeatDialog{position:fixed;left:50%;top:62%;transform:translate(-50%,-50%);z-index:9450;display:none;padding:18px 22px;border-radius:12px;background:rgba(0,0,0,0.85);color:#ffd200;font-weight:800;font-size:20px}
#flashOverlay{position:fixed;inset:0;display:none;z-index:2147483646;background:white;opacity:0;pointer-events:none}

/* lamp lit */
.lamp .light-halo{position:absolute;left:50%;top:26%;transform:translate(-50%,-50%);width:160px;height:160px;border-radius:50%;pointer-events:none;opacity:0;transition:opacity 360ms ease}
.lamp.lit .light-halo{opacity:1;background:radial-gradient(circle at 50% 40%, rgba(255,230,120,0.95) 0%, rgba(255,200,80,0.75) 35%, rgba(255,160,20,0.25) 60%, rgba(0,0,0,0) 80%)}
.lamp .bulb-shape{transition:filter 360ms ease, transform 360ms ease}
.lamp.lit .bulb-shape{filter:drop-shadow(0 0 30px var(--lamp-glow))}

/* responsive */
@media (max-width:480px){ :root{--device-w:44px;--device-h:52px} }
