/* style.css */
:root{
  --bg:#000;
  --panel:#e6e6e6;
  --term-bg:#222;
  --wire:#000000;
  --wirew:6;
  --device-w:86px;
  --device-padding:8px;
  --boss-hp-color:#e74c3c;
  --boss-hp-back:#2b1818;
  --light-yellow: #ffd800;
}
html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
#wireLayer{position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:3000}

/* header */
.header{display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
.title{font-size:20px;margin:0;font-weight:700}
.hp-area{width:46%;min-width:180px}
.bar{width:100%;height:12px;background:#222;border-radius:12px;overflow:hidden}
.player{height:100%;width:100%;background:#34d058;border-radius:12px}

/* board */
#board-wrap{position:relative;width:100%;height:calc(100vh - 240px);box-sizing:border-box;padding:8px 16px;overflow:hidden}
#board{position:relative;width:100%;height:100%}

/* devices */
.device{position:absolute;width:var(--device-w);padding:var(--device-padding);background:var(--panel);border-radius:12px;color:#000;box-shadow:0 12px 30px rgba(0,0,0,0.5);transform:translate(-50%,-50%);text-align:center;z-index:60;display:flex;flex-direction:column;align-items:center;justify-content:center}
.device .icon-wrap{width:56px;height:56px;display:flex;align-items:center;justify-content:center;margin-bottom:6px}
.device .device-icon{width:56px;height:56px}
.device .term-row{display:flex;gap:8px}
.device .terminal{width:30px;height:30px;border-radius:50%;background:var(--term-bg);color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:pointer;user-select:none}
.device.junction{width:120px;padding:10px;background:#d6d6d6;border-radius:14px;z-index:70}
.jb-dots{display:flex;flex-wrap:wrap;justify-content:center;gap:8px}
.jb-term{width:18px;height:18px;border-radius:50%;background:#222;display:inline-block;cursor:pointer}

/* selected terminal */
.terminal.selected{outline:3px solid var(--light-yellow)}

/* lamp specifics */
.lamp{width:66px;height:66px;padding:6px;background:transparent;border-radius:50%;box-shadow:none;color:#fff}
.bulb-shape.icon{width:46px;height:46px}
.light-halo{position:absolute;inset:auto;left:50%;top:18%;transform:translateX(-50%);width:0;height:0;border-radius:50%;pointer-events:none;opacity:0;transition:opacity 300ms ease, width 300ms ease, height 300ms ease;z-index:55}
.lamp.lit .light-halo{width:120px;height:120px;opacity:0.9;box-shadow:0 0 40px 16px rgba(255,216,64,0.12);background:radial-gradient(circle,#fff6c6 0%, rgba(255,216,64,0.12) 40%, rgba(255,216,64,0.02) 80%)}

/* controls */
.controls{height:180px;padding:12px 18px;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}
button.big{padding:14px 36px;border-radius:26px;border:none;background:#ffd000;color:#000;font-weight:700}
button.small{padding:8px 12px;margin:8px;border-radius:12px;border:none;background:#333;color:#fff}
.note{font-size:13px;color:#bbb;text-align:center;margin-top:8px}

/* modal and screens */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.75);display:none;align-items:flex-start;justify-content:center;flex-direction:column;padding:36px;z-index:9500;pointer-events:auto}
.modal-backdrop.show{display:flex}
.titleBig{font-size:40px;color:#ffd200;font-weight:800;margin-bottom:12px}
.quizBox{background:#111;padding:18px;border-radius:12px;max-width:760px;color:#fff}

/* boss panel & damage */
#bossScreen{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;z-index:9200;color:#fff}
#bossPanel{width:86%;max-width:720px;background:#0d0d0d;border-radius:14px;padding:18px;box-shadow:0 20px 60px rgba(0,0,0,0.7);display:flex;gap:18px;align-items:center}
.bossImg{width:220px;height:220px;object-fit:cover;border-radius:8px;background:#222;display:flex;align-items:center;justify-content:center;color:#ccc}
#bossName{font-size:20px;color:#ffd200;margin-right:12px;font-weight:800;white-space:nowrap}
.bossHPback{flex:1;background:var(--boss-hp-back);height:18px;border-radius:12px;overflow:hidden}
.bossHPbar{height:100%;width:100%;background:var(--boss-hp-color);transition:width 700ms ease;border-radius:12px}

/* hit text */
#hitText{position:absolute;top:8%;left:50%;transform:translateX(-50%);font-size:56px;color:#fff;z-index:9300;display:none;text-shadow:0 6px 18px rgba(0,0,0,0.6);font-weight:900}

/* damage animations */
@keyframes flashRed { 0%{filter:none;opacity:1}25%{filter:drop-shadow(0 0 20px rgba(231,76,60,0.95));opacity:1}50%{filter:none;opacity:0.9}75%{filter:drop-shadow(0 0 20px rgba(231,76,60,0.95));opacity:1}100%{filter:none;opacity:1} }
@keyframes shake { 0%{transform:translateX(0)}10%{transform:translateX(-8px)}20%{transform:translateX(8px)}30%{transform:translateX(-6px)}40%{transform:translateX(6px)}50%{transform:translateX(-4px)}60%{transform:translateX(4px)}70%{transform:translateX(-2px)}80%{transform:translateX(2px)}100%{transform:translateX(0)} }
.boss-damage{animation: flashRed 400ms ease-in-out 0s 4 both, shake 420ms ease-in-out 0s 4 both;}

/* explosion */
.explosion{position:fixed;left:50%;top:40%;transform:translate(-50%,-50%) scale(0.01);width:260px;height:260px;border-radius:50%;pointer-events:none;z-index:9400;display:none;background:radial-gradient(circle at 50% 50%, rgba(255,230,120,0.95) 0%, rgba(255,140,20,0.9) 30%, rgba(220,40,10,0.85) 60%, rgba(0,0,0,0) 70%);}

/* defeat dialog */
.defeatDialog{position:fixed;left:50%;top:62%;transform:translate(-50%,-50%);z-index:9450;display:none;padding:18px 22px;border-radius:12px;background:rgba(0,0,0,0.8);color:#ffd200;font-weight:800;font-size:20px}

/* final video overlay */
#finalVideoWrap{position:fixed;inset:0;display:none;z-index:2147483646;background:rgba(0,0,0,0.95);align-items:center;justify-content:center}
#finalVideo{position:fixed;inset:0;width:100%;height:100%;object-fit:cover;z-index:2147483647;display:block}

/* particle */
.particle{position:fixed;width:12px;height:12px;border-radius:50%;pointer-events:none;z-index:9500;opacity:1}

/* flash overlay */
.flashOverlay{position:fixed;inset:0;display:none;z-index:9501;background:#fff;opacity:0;pointer-events:none}

/* overlay */
.overlay{position:fixed;inset:0;display:none;z-index:9600;background:rgba(0,0,0,0.6);align-items:center;justify-content:center}

/* quiz chosen style */
.quizOpt.chosen{outline:3px solid #ffd200; background:#222; color:#fff}

/* responsive */
@media (max-width:480px){
  :root{--device-w:68px;}
  .title{font-size:18px}
  #board-wrap{height:calc(100vh - 260px)}
}
