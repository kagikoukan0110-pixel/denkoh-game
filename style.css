:root{
  --device-scale:0.66;
  --panel:#e6e6e6;
  --term-bg:#222;
  --wire-black:#111; /* visible dark */
  --wire-white:#ffffff;
  --wire-red:#ff3b30;
}

/* base */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}

/* header */
.header{display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
.title{font-size:20px;margin:0;font-weight:700}
.hp-area{width:36%;min-width:140px}
.bar{width:100%;height:12px;background:#222;border-radius:12px;overflow:hidden}
.player{height:100%;width:100%;background:#34d058;border-radius:12px}

/* board */
.board{position:relative;width:100%;height:calc(100vh - 240px);padding:8px 16px;overflow:hidden}
#wireLayer{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}

/* device */
.device{position:absolute;width:120px;padding:10px;background:var(--panel);border-radius:12px;color:#000;box-shadow:0 12px 30px rgba(0,0,0,0.5);transform:translate(-50%,-50%) scale(var(--device-scale));text-align:center;z-index:60}
.terminal{display:inline-flex;justify-content:center;align-items:center;width:34px;height:34px;margin:4px;background:var(--term-bg);color:#fff;border-radius:50%;font-size:12px;cursor:pointer;user-select:none}
.terminal.selected{outline:3px solid #ffd800}

/* power */
.power{width:110px;height:64px}
.powerToggle{width:48px;height:28px;border-radius:6px;background:#111;display:flex;align-items:center;justify-content:space-between;padding:3px}
.powerToggle .toggle-on{width:16px;height:22px;background:#ffd000;border-radius:4px}
.powerToggle .toggle-off{width:16px;height:22px;background:#999;border-radius:4px}

/* switches */
.sw{width:110px;height:110px}
.swBtn{background:#fff;border-radius:8px;padding:6px 8px;border:none;cursor:pointer;margin-bottom:6px}

/* junction */
.junction{width:240px;height:92px;display:flex;flex-direction:column;align-items:center;justify-content:center}
.jbRow{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap}

/* lamp */
.lamp{width:96px;height:120px;border-radius:12px;padding-top:12px;display:flex;flex-direction:column;align-items:center;justify-content:space-between}
.lampBulb{width:44px;height:60px;background:#f2f2f2;border-radius:50% 50% 40% 40%;box-shadow:inset 0 6px 10px rgba(0,0,0,.06);transition:transform .18s,filter .18s}
.lamp.lit{background:#ffd54a}
.lamp.lit .lampBulb{background:#fff;filter:drop-shadow(0 12px 40px rgba(255,200,80,.6));transform:scale(1.02)}

/* controls */
.controls{height:140px;padding:12px 18px;display:flex;align-items:center;justify-content:center;gap:12px}
.primary{background:#ffd000;border:none;padding:14px 36px;border-radius:26px;font-weight:800;cursor:pointer}
.small{background:#333;border:none;padding:8px 16px;border-radius:18px;color:#fff}

/* modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.75);display:none;align-items:flex-start;justify-content:center;flex-direction:column;padding:36px;z-index:9500}
.modal-backdrop.show{display:flex}
.titleBig{font-size:40px;color:#ffd200;font-weight:800;margin-bottom:12px}

/* quiz option highlight */
.quizOpt{background:#222;color:#fff;border-radius:8px;padding:8px 10px;border:none;cursor:pointer;text-align:left}
.quizOpt.chosen{background:#ffd000;color:#000;font-weight:800}

/* boss */
#bossPanel{width:86%;max-width:720px;background:#0d0d0d;border-radius:14px;padding:18px;box-shadow:0 20px 60px rgba(0,0,0,0.7);display:flex;gap:18px;align-items:center}
#bossImg{width:180px;height:180px;border-radius:8px}
.bossHPback{width:100%;height:18px;background:#2b1818;border-radius:12px;overflow:hidden}
.bossHPbar{height:100%;width:100%;background:#e74c3c;transition:width 700ms ease;border-radius:12px}

/* small screens */
@media (max-width:480px){
  :root{ --device-scale:0.62; }
  .titleBig{font-size:28px}
  .board{height:calc(100vh - 200px)}
}
