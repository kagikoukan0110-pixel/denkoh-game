<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>俺らの電工 presents by 貴電</title>
<style>
* { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
body { margin: 0; padding: 0; background: #000; color: #fff; font-family: 'Arial Black', sans-serif; overflow: hidden; }
.hidden { display: none !important; }

/* タイトル */
#titleScreen { position: fixed; inset: 0; background: radial-gradient(circle, #222 0%, #000 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; }
.title-logo { font-size: 40px; color: #ffd000; text-shadow: 0 0 20px #ffaa00; }
.subtitle { font-size: 18px; margin-top: 10px; color: #ff4444; letter-spacing: 4px; }

/* クイズ */
#quizScreen { position: fixed; inset: 0; background: #111; z-index: 9000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; overflow-y: auto; }
.quiz-mark { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; font-size: 250px; font-weight: bold; pointer-events: none; opacity: 0; z-index: 9500; }

/* ゲーム画面 */
#gameScreen { position: fixed; inset: 0; display: flex; flex-direction: column; z-index: 100; transition: filter 0.1s; }
#statusHeader { height: 60px; border-bottom: 3px solid #ffd000; display: flex; justify-content: space-around; align-items: center; background: #111; font-size: 12px; }
.hp-label { font-weight: bold; padding: 4px 8px; border-radius: 4px; }
#playerHpBox { background: #004400; color: #0f0; border: 1px solid #0f0; }
#bossHpBox { background: #440000; color: #ff4444; border: 1px solid #ff4444; }

#board { flex: 1; position: relative; background: #0a0a0a; overflow: hidden; }

/* 配線レイヤー */
#wireLayer { position: absolute; inset: 0; width: 100%; height: 100%; z-index: 50; pointer-events: none; }

/* デバイス */
.device { position: absolute; background: #ccc; color: #000; border: 2px solid #444; border-radius: 4px; padding: 6px; text-align: center; z-index: 20; transform: translate(-50%, -50%); box-shadow: 4px 4px 0 #000; min-width: 90px; }
.dev-title { font-size: 11px; font-weight: bold; border-bottom: 1px solid #777; margin-bottom: 8px; background: #ddd; padding: 2px; }
.term { width: 28px; height: 28px; background: #222; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 13px; cursor: pointer; border: 2px solid #000; position: relative; z-index: 60; }
.term.sel { background: #ffd000 !important; color: #000; box-shadow: 0 0 15px #ffd000; }

/* 3路スイッチ配置（貴電厳守） */
.layout-3way-left { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
.layout-3way-right { display: flex; align-items: center; justify-content: space-between; gap: 8px; flex-direction: row; }
.term-col { display: flex; flex-direction: column; gap: 8px; }

.dev-lamp.on { background: #ffd000; box-shadow: 0 0 60px #ffd000; }

/* 配線 */
.wire-white { stroke: #fff; stroke-width: 8; fill: none; stroke-linecap: round; }
.wire-black { stroke: #111; stroke-width: 9; fill: none; stroke-linecap: round; }
.wire-glow { stroke: #ffd000; stroke-width: 6; stroke-dasharray: 10, 15; animation: flow 0.5s linear infinite; fill: none; display: none; }
@keyframes flow { from { stroke-dashoffset: 25; } to { stroke-dashoffset: 0; } }

/* コントロール */
#controls { height: 100px; background: #111; display: flex; justify-content: center; align-items: center; gap: 20px; border-top: 2px solid #333; z-index: 1000; position: relative; }
.btn-set { padding: 15px 50px; background: #ffd000; border: none; border-radius: 8px; font-size: 22px; font-weight: bold; cursor: pointer; color: #000; box-shadow: 0 4px 0 #b39200; }
.btn-set:active { transform: translateY(2px); box-shadow: none; }

/* ボス演出 */
#bossBattleOverlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 10000; display: none; flex-direction: column; align-items: center; justify-content: center; }
.boss-img-container { position: relative; width: 280px; height: 280px; margin: 20px 0; }
.boss-img { width: 100%; height: 100%; object-fit: contain; }
#bossHpBar { width: 80%; height: 30px; background: #333; border: 3px solid #fff; position: relative; }
#bossHpFill { width: 100%; height: 100%; background: linear-gradient(to right, #f00, #ff6a00); transition: width 0.4s ease-out; }

/* 最終演出 */
#finalEffectLayer { position: fixed; inset: 0; background: #fff; z-index: 20000; display: none; }
#puchunOverlay { position: fixed; inset: 0; background: #000; z-index: 21000; display: none; align-items: center; justify-content: center; }
#pLine { width: 100%; height: 4px; background: #fff; transform: scaleX(0); }
#gekihaScreen { position: fixed; inset: 0; background: radial-gradient(circle, #444 0%, #000 100%); z-index: 30000; display: none; align-items: center; justify-content: center; flex-direction: column; }
#gekihaText { color: #ffd000; font-size: 140px; font-weight: 900; text-shadow: 0 0 50px #f00; transform: scale(5); opacity: 0; transition: 0.4s cubic-bezier(0.17, 0.84, 0.44, 1); }

/* アニメーション */
@keyframes flash { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
.v-flash { animation: flash 0.05s infinite; }
.v-mono { filter: grayscale(100%) contrast(2) brightness(0.7); }
.shake { animation: shake 0.1s infinite; }
@keyframes shake { 0% { transform: translate(0,0); } 25% { transform: translate(10px, 10px); } 75% { transform: translate(-10px, -10px); } }
@keyframes explode { 0% { background: #fff; } 20% { background: #ffaa00; } 40% { background: #ff0000; } 100% { background: #000; } }
.v-explode { animation: explode 0.4s steps(5) infinite; }
</style>
</head>
<body>

<div id="titleScreen">
    <div class="title-logo">俺らの電工</div>
    <div class="subtitle">~ presents by 貴電 ~</div>
    <button style="margin-top:50px; padding:20px 60px; background:#ffd000; border:none; border-radius:40px; font-weight:bold; font-size:22px; cursor:pointer;" onclick="startFlow()">現場へ入場</button>
</div>

<div id="quizScreen" class="hidden">
    <div id="qText" style="font-size:20px; margin-bottom:30px; text-align:center; padding:0 20px; line-height:1.4;"></div>
    <div id="ansBox" style="width:100%; display:flex; flex-direction:column; gap:15px; align-items:center;"></div>
</div>
<div id="quizResult" class="quiz-mark"></div>

<div id="gameScreen" class="hidden">
    <div id="statusHeader">
        <div id="dispWorld" style="color:#ffd000; font-weight:bold;">WORLD 1</div>
        <div id="playerHpBox" class="hp-label">俺の体力: <span id="playerHpText">100</span></div>
        <div id="bossHpBox" class="hp-label">BOSS HP: <span id="bossHpText">100</span></div>
    </div>
    <div id="board"><svg id="wireLayer"></svg></div>
    <div id="controls">
        <button onclick="resetWires()" style="padding:12px 24px; background:#444; color:#fff; border:none; border-radius:5px; cursor:pointer; font-weight:bold;">解線</button>
        <button class="btn-set" onclick="checkCircuit()">点灯試験 (SET)</button>
    </div>
</div>

<div id="bossBattleOverlay">
    <div id="bossMsg" style="color:#ff4444; font-size:28px; font-weight:bold; text-shadow: 0 0 10px #000;">点灯成功！ボスにダメージ！！</div>
    <div class="boss-img-container" id="bossContainer">
        <img src="boss.jpg" class="boss-img" alt="BOSS" onerror="this.src='https://via.placeholder.com/280/FF0000/FFFFFF?text=DIRTY_DAIKU'">
    </div>
    <div id="bossHpBar"><div id="bossHpFill"></div></div>
</div>

<div id="finalEffectLayer"></div>
<div id="puchunOverlay"><div id="pLine"></div></div>
<div id="gekihaScreen">
    <div id="gekihaText">撃破</div>
    <button id="nextBtn" class="hidden" style="margin-top:60px; padding:20px 60px; background:#ffd000; border:none; border-radius:10px; font-weight:bold; font-size:20px; cursor:pointer;" onclick="advanceGame()">次の工区へ</button>
</div>

<script>
const el = id => document.getElementById(id);
let world = 1, phase = 1, bossHp = 100, playerHp = 100, qIdx = 0, lines = [], selTerm = null;
let currentQuizzes = [];
let swStates = { sw1:false, swA:false, swB:false };

// ガチ50問クイズプール
const quizPool = [
    {q:"接地側電線（N）の絶縁被覆の色は？", a:["黒","白","赤","緑"], c:1},
    {q:"VVF1.6-2cの「2c」とは何のこと？", a:["2センチ","2芯","2重被覆","2サイクル"], c:1},
    {q:"一般用電気工作物の100V回路の絶縁抵抗値は何[MΩ]以上？", a:["0.1","0.2","0.4","1.0"], c:0},
    {q:"リングスリーブ用圧着工具で、黄色いハンドルのものは？", a:["絶縁被覆付用","裸端子用","リングスリーブ用","ボルト用"], c:2},
    {q:"3路スイッチの共通端子番号はどれ？", a:["0","1","2","3"], c:0},
    {q:"コンセントの左側の長い穴はどっち？", a:["電圧側","接地側","接地極","接続なし"], c:1},
    {q:"電圧の単位はどれ？", a:["A","W","V","Ω"], c:2},
    {q:"回路を保護する「B」の記号が指すものは？", a:["配線用遮断器","漏電遮断器","電磁開閉器","点滅器"], c:0},
    {q:"単相3線式100/200Vの中性線は何色？", a:["黒","赤","白","青"], c:2},
    {q:"合成樹脂管（PVC）の記号は？", a:["E","VE","F","C"], c:1},
    {q:"抵抗器に流れる電流は電圧に？", a:["比例する","反比例する","無関係","二乗する"], c:0},
    {q:"4路スイッチを使用するのはどんな時？", a:["1カ所点滅","2カ所点滅","3カ所以上点滅","点滅不可"], c:2},
    {q:"ゴムブッシングを使用する目的は？", a:["電線の保護","絶縁の強化","美観のため","防水のため"], c:0},
    {q:"力率を改善するために設置するものは？", a:["抵抗器","コイル","進相コンデンサ","トランス"], c:2},
    {q:"電線の接続を必ず行わなければならない場所は？", a:["管内","ボックス内","どこでもよい","壁の内部"], c:1},
    {q:"金属管工事で管の端に取り付けるものは？", a:["ブッシング","ジョイント","カップリング","サドル"], c:0},
    {q:"交流100Vの最大値は約何V？", a:["100","141","200","50"], c:1},
    {q:"三相交流の起電力の位相差は？", a:["90度","120度","180度","360度"], c:1},
    {q:"接地極の記号は？", a:["S","H","E","L"], c:2},
    {q:"埋込連用タンブラスイッチの記号は？", a:["S","T","M","B"], c:0},
    {q:"絶縁電線の許容電流は周囲温度が上がると？", a:["増える","減る","変わらない","倍になる"], c:1},
    {q:"PF管は何の略？", a:["合成樹脂管","可とう電線管","硬質塩化ビニル","金属ダクト"], c:1},
    {q:"リングスリーブの「小」に1.6mm2本を接続した時の刻印は？", a:["○","小","中","大"], c:0},
    {q:"アウトレットボックスのノックアウトを抜く工具は？", a:["ペンチ","電工ナイフ","ドライバ","ウォータポンププライヤ"], c:2},
    {q:"誘導電動機の回転速度を計算する要素は周波数と？", a:["電圧","電流","極数","抵抗"], c:2},
    {q:"回路の電流を測る電流計は回路にどう繋ぐ？", a:["直列","並列","混合","繋がない"], c:0},
    {q:"電気工事士免状の交付を受ける場所は？", a:["警察署","消防署","都道府県知事","市役所"], c:2},
    {q:"低圧とは交流で何V以下？", a:["300","600","750","1000"], c:1},
    {q:"電力の単位はどれ？", a:["V","A","W","Ω"], c:2},
    {q:"電力量の単位はどれ？", a:["W","Wh","V","A"], c:1},
    {q:"パイロットランプの「常時点灯」の結線は？", a:["負荷と並列","負荷と直列","電源に直接","結線不要"], c:2},
    {q:"木造住宅で最も多く使われる配線方式は？", a:["金属管","合成樹脂管","露出配線","ケーブル工事"], c:3},
    {q:"電線の被覆を剥く際に最も効率的な工具は？", a:["電工ナイフ","VVFストリッパー","ペンチ","ニッパ"], c:1},
    {q:"アースを接続する理由は？", a:["感電防止","節電","電圧上昇","美観"], c:0},
    {q:"三相3線式200Vの電圧側電線の色は？（一般的に）", a:["黒・白・緑","赤・白・青","黒・赤・白","黒・赤・青"], c:3},
    {q:"回路の絶縁を確認する時に使う計器は？", a:["テスタ","メガー","クランプメータ","検電器"], c:1},
    {q:"電気が通っているか確認する棒状の器具は？", a:["検電器","電圧計","導通計","抵抗計"], c:0},
    {q:"より線の太さを表す単位は？", a:["mm","mm2","inch","cm"], c:1},
    {q:"1.6mmの単線の断面積は約何mm2？", a:["1.6","2.0","3.14","5.5"], c:1},
    {q:"D種接地工事の接地抵抗値は何Ω以下？", a:["10","100","500","1000"], c:1},
    {q:"防雨形コンセントの記号は？", a:["WP","ET","ELP","E"], c:0},
    {q:"確認表示灯内蔵スイッチ（ホタル）の記号は？", a:["S","H","L","P"], c:1},
    {q:"位置表示灯内蔵スイッチの記号は？", a:["L","H","M","S"], c:0},
    {q:"点滅器の図記号の傍記「3」の意味は？", a:["3カ所","3極","3路","300V"], c:2},
    {q:"天井付換気扇の図記号は？", a:["F","P","V","S"], c:2},
    {q:"配線図で「○」の中に「L」の記号は？", a:["蛍光灯","壁付灯","誘導灯","白熱灯"], c:3},
    {q:"ジョイントボックスの図記号は？", a:["□","○","×","△"], c:1},
    {q:"単極スイッチの図記号は？", a:["●","○","◎","□"], c:0},
    {q:"この現場を提供している最高な奴は？", a:["汚ねえ大工","そこらの奴","貴電","通りすがり"], c:2},
    {q:"電気工事で最も大切なことは？", a:["スピード","美観","安全","安さ"], c:2}
];

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function startFlow() {
    el('titleScreen').classList.add('hidden');
    el('quizScreen').classList.remove('hidden');
    qIdx = 0;
    currentQuizzes = shuffle([...quizPool]).slice(0, 5);
    updateHpUI();
    loadQuiz();
}

function updateHpUI() {
    el('playerHpText').innerText = playerHp;
    el('bossHpText').innerText = bossHp;
    if(playerHp <= 0) {
        alert("施工不能... 現場から叩き出された。");
        location.reload();
    }
}

function loadQuiz() {
    if(qIdx >= 5) { 
        el('quizScreen').classList.add('hidden'); 
        el('gameScreen').classList.remove('hidden'); 
        initBoard(); 
        return; 
    }
    const q = currentQuizzes[qIdx];
    el('qText').innerText = `【第${qIdx+1}問】\n${q.q}`;
    el('ansBox').innerHTML = '';
    q.a.forEach((t, i) => {
        const b = document.createElement('button');
        b.style = "width:90%; padding:18px; background:#222; color:#fff; border:2px solid #ffd000; border-radius:10px; font-size:16px; cursor:pointer; font-weight:bold; text-align:left;";
        b.innerText = `${i+1}. ${t}`;
        b.onclick = () => {
            const ok = (i === q.c);
            if(!ok) {
                playerHp -= 20;
                updateHpUI();
            }
            el('quizResult').innerText = ok ? '◯' : '×';
            el('quizResult').style.color = ok ? '#00f2ff' : 'red';
            el('quizResult').style.opacity = 1;
            setTimeout(() => { 
                el('quizResult').style.opacity = 0; 
                qIdx++; 
                loadQuiz(); 
            }, 500);
        };
        el('ansBox').appendChild(b);
    });
}

function initBoard() {
    updateHpUI();
    el('dispWorld').innerText = `WORLD ${world}`;
    el('board').querySelectorAll('.device').forEach(d => d.remove());
    lines = []; drawWires();

    addDev('p', '電源', 50, 18, [['p-L','L'],['p-N','N']], 'dev-breaker', 'std');
    addDev('jb', 'JB', 50, 45, [['j1','1'],['j2','2'],['j3','3'],['j4','4'],['j5','5'],['j6','6']], 'dev-jb', 'std');

    if(world === 1) {
        addDev('sw1', '片切SW', 30, 80, [['s1-0','0'],['s1-1','1']], 'dev-sw', 'std');
        for(let i=0; i<phase; i++) addDev(`l${i}`, `ランプ${i+1}`, 55+(i*15), 75, [[`l${i}-L`,'L'],[`l${i}-N`,'N']], 'dev-lamp', 'std');
    } else {
        addDev('swA', '3路SW(左)', 20, 80, [['a-0','0'],['a-1','1'],['a-3','3']], 'dev-sw', '3way-left');
        addDev('swB', '3路SW(右)', 55, 80, [['b-1','1'],['b-3','3'],['b-0','0']], 'dev-sw', '3way-right');
        for(let i=0; i<phase; i++) addDev(`l${i}`, `ランプ${i+1}`, 85, 45+(i*18), [[`l${i}-L`,'L'],[`l${i}-N`,'N']], 'dev-lamp', 'std');
    }

    document.querySelectorAll('.term').forEach(t => t.onclick = handleTerm);
    document.querySelectorAll('.dev-sw').forEach(sw => sw.onclick = () => {
        const id = sw.dataset.devid;
        swStates[id] = !swStates[id];
        sw.style.filter = swStates[id] ? "brightness(1.5) drop-shadow(0 0 10px gold)" : "none";
    });
}

function addDev(id, title, x, y, terms, cls, layout) {
    const d = document.createElement('div');
    d.className = `device ${cls}`; d.dataset.devid = id;
    d.style.left = x + '%'; d.style.top = y + '%';
    let h = `<div class="dev-title">${title}</div>`;
    if(layout==='std') h += `<div class="term-row" style="display:flex; justify-content:center; gap:12px; padding:5px;">` + terms.map(t=>`<div class="term" data-tid="${t[0]}">${t[1]}</div>`).join('') + `</div>`;
    else if(layout==='3way-left') h += `<div class="layout-3way-left"><div class="term" data-tid="${terms[0][0]}">${terms[0][1]}</div><div class="term-col"><div class="term" data-tid="${terms[1][0]}">${terms[1][1]}</div><div class="term" data-tid="${terms[2][0]}">${terms[2][1]}</div></div></div>`;
    else if(layout==='3way-right') h += `<div class="layout-3way-right"><div class="term-col"><div class="term" data-tid="${terms[0][0]}">${terms[0][1]}</div><div class="term" data-tid="${terms[1][0]}">${terms[1][1]}</div></div><div class="term" data-tid="${terms[2][0]}">${terms[2][1]}</div></div>`;
    d.innerHTML = h; el('board').appendChild(d);
}

function handleTerm(e) {
    const tid = e.target.dataset.tid;
    if(!selTerm) { selTerm = tid; e.target.classList.add('sel'); }
    else {
        if(selTerm !== tid) lines.push([selTerm, tid]);
        document.querySelectorAll('.term').forEach(t => t.classList.remove('sel'));
        selTerm = null; drawWires();
    }
}

function drawWires() {
    const svg = el('wireLayer'); svg.innerHTML = '';
    const b = el('board').getBoundingClientRect();
    lines.forEach(pair => {
        const t1 = document.querySelector(`[data-tid="${pair[0]}"]`);
        const t2 = document.querySelector(`[data-tid="${pair[1]}"]`);
        if(!t1 || !t2) return;
        const r1 = t1.getBoundingClientRect(), r2 = t2.getBoundingClientRect();
        const x1 = r1.left - b.left + r1.width/2, y1 = r1.top - b.top + r1.height/2;
        const x2 = r2.left - b.left + r2.width/2, y2 = r2.top - b.top + r2.height/2;
        const isWhite = pair[0].includes('-N') || pair[1].includes('-N');
        const p = document.createElementNS("http://www.w3.org/2000/svg", "path");
        p.setAttribute("d", `M ${x1} ${y1} L ${x2} ${y2}`);
        p.setAttribute("class", isWhite ? "wire-white" : "wire-black");
        svg.appendChild(p);
        const g = p.cloneNode(); g.setAttribute("class", "wire-glow"); svg.appendChild(g);
    });
}

function resetWires() { lines = []; drawWires(); }

function checkCircuit() {
    const adj = {};
    const addE = (u,v) => { if(!adj[u])adj[u]=[]; if(!adj[v])adj[v]=[]; adj[u].push(v); adj[v].push(u); };
    lines.forEach(l => addE(l[0], l[1]));
    if(world === 1 && swStates.sw1) addE('s1-0', 's1-1');
    if(world === 2) {
        addE('a-0', swStates.swA ? 'a-3' : 'a-1');
        addE('b-0', swStates.swB ? 'b-3' : 'b-1');
    }
    const getNet = (s) => {
        const seen = new Set(), q = [s];
        while(q.length){ const v = q.shift(); if(!seen.has(v)){ seen.add(v); (adj[v]||[]).forEach(n=>q.push(n)); } }
        return seen;
    };
    const netL = getNet('p-L'), netN = getNet('p-N');
    
    // 短絡チェック
    if(netL.has('p-N')) { 
        alert("短絡（ショート）！貴電の恥だぞ！"); 
        playerHp -= 10;
        updateHpUI();
        resetWires(); 
        return; 
    }
    
    let ok = 0;
    for(let i=0; i<phase; i++) if(netL.has(`l${i}-L`) && netN.has(`l${i}-N`)) {
        ok++; el('board').querySelector(`[data-devid="l${i}"]`).classList.add('on');
    }

    if(ok === phase) {
        document.querySelectorAll('.wire-glow').forEach(w => w.style.display='block');
        setTimeout(showBossDamage, 800);
    } else {
        alert("不点灯... 回路を見直せ。");
        playerHp -= 10;
        updateHpUI();
    }
}

function showBossDamage() {
    const bossScr = el('bossBattleOverlay');
    const hpFill = el('bossHpFill');
    const container = el('bossContainer');
    bossScr.style.display = 'flex';
    hpFill.style.width = bossHp + '%';
    
    setTimeout(() => {
        bossHp -= 34;
        if(bossHp < 0) bossHp = 0;
        hpFill.style.width = bossHp + '%';
        container.classList.add('shake');
        
        setTimeout(() => {
            container.classList.remove('shake');
            if(bossHp <= 0) {
                triggerFinalFatality();
            } else {
                bossScr.style.display = 'none';
                phase++;
                initBoard();
            }
        }, 1000);
    }, 500);
}

function triggerFinalFatality() {
    const gs = el('gameScreen');
    const effect = el('finalEffectLayer');
    const puchun = el('puchunOverlay');
    const line = el('pLine');
    const gekihaScr = el('gekihaScreen');
    const gekihaTxt = el('gekihaText');

    effect.style.display = 'block';
    effect.classList.add('v-explode');
    
    setTimeout(() => {
        effect.classList.remove('v-explode');
        effect.classList.add('v-flash');
        
        setTimeout(() => {
            effect.style.display = 'none';
            el('bossBattleOverlay').classList.add('v-mono');
            gs.classList.add('v-mono');
            
            setTimeout(() => {
                puchun.style.display = 'flex';
                line.style.transition = "transform 0.4s ease-in";
                line.style.transform = "scaleX(1)";
                
                setTimeout(() => {
                    line.style.transition = "transform 0.1s linear";
                    line.style.transform = "scaleX(0) scaleY(0)"; 
                    
                    setTimeout(() => {
                        gekihaScr.style.display = 'flex';
                        setTimeout(() => {
                            gekihaTxt.style.opacity = 1;
                            gekihaTxt.style.transform = "scale(1)";
                            el('nextBtn').classList.remove('hidden');
                        }, 100);
                    }, 500);
                }, 600);
            }, 1000);
        }, 1200);
    }, 1000);
}

function advanceGame() {
    if(world === 1) {
        world = 2; phase = 1; bossHp = 100;
        el('bossBattleOverlay').style.display = 'none';
        el('bossBattleOverlay').classList.remove('v-mono');
        el('gameScreen').classList.remove('v-mono');
        el('gekihaScreen').style.display = 'none';
        el('puchunOverlay').style.display = 'none';
        el('gekihaText').style.opacity = 0;
        el('gekihaText').style.transform = "scale(5)";
        el('nextBtn').classList.add('hidden');
        startFlow();
    } else {
        alert("貴電の全工区、完遂！君こそが伝説の工区長だ！");
        location.reload();
    }
}
</script>
</body>
</html>
